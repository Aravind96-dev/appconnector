<html>

<head>
    <title>Open App ðŸ‘‰</title>
    <meta http-equiv="Cache-Control" content="no-cache" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
</head>

<body>
    <script>
        
       
        
      function openApp(){
          var userAgent = navigator.userAgent || navigator.vendor || window.opera;
        const locationPath = window.location.hash;
        const encodedChiperTextParam = new URLSearchParams(locationPath.slice(locationPath.indexOf("?")));
        const decodeURIParam = decodeURIComponent(encodedChiperTextParam.get('param'));
        const plainTextParam = CryptoJS.AES.decrypt(decodeURIParam, 'RLm-Auf76eshsdafuUSDfa').toString(CryptoJS.enc.Utf8);
        const pramList = plainTextParam.split("/");
        const scheme = 'com.gofrugal.' + pramList[pramList.length - 2];
        const appleId = pramList[pramList.length - 1];
       
//         setTimeout(function () {
//             if (/android/i.test(userAgent)) {
//                 window.location.assign('market://details?id=' + scheme);
//             }
//             if (/(ipad|iphone|ipod)/.test(navigator.userAgent.toLowerCase())) {
//                 window.location.assign(`itms-apps://itunes.apple.com/app/id${appleId}`);
//             }
//         }, 1000);
//         window.open(scheme+"://" + scheme + "/" + plainTextParam,'_self');    
      }
      
//        var timeout;
// window.addEventListener('blur',function(e){
//     window.clearTimeout(timeout);
// })
        
//         document.addEventListener("visibilitychange", function() {
//         // check for page visibility
//              if(document.hidden) {
//                  console.log('cleared');
//            window.clearTimeout(timeout);
//     } else {
//          console.log('visible');
//     }
//     });

// timeout = setTimeout(function () {
//             if (/android/i.test(userAgent)) {
//                 window.location = 'market://details?id=' + scheme;
//             }
//             if (/(ipad|iphone|ipod)/.test(navigator.userAgent.toLowerCase())) {
//                 window.location =`itms-apps://itunes.apple.com/app/id${appleId}`;
//             }
//         }, 1000);
//         window.location =scheme+"://" + scheme + "/" + plainTextParam;   
         
        
//         var change = false;
// setTimeout(() => {
//   if (!change) {
//     var redirectUrl = `itms-apps://itunes.apple.com/app/id${appleId}`;
//     window.location = redirectUrl;
//   }
// }, 3000);
// window.location = scheme+"://" + scheme + "/" + plainTextParam;
// //handle event to check app installed or not
// window.onblur = function () {
//     change = true;
// };
// window.onfocus = function(){
//     change = false;
// }
         function init() {
             alert('init success')
        // Put your code here
               var userAgent = navigator.userAgent || navigator.vendor || window.opera;
        const locationPath = window.location.hash;
        const encodedChiperTextParam = new URLSearchParams(locationPath.slice(locationPath.indexOf("?")));
        const decodeURIParam = decodeURIComponent(encodedChiperTextParam.get('param'));
        const plainTextParam = CryptoJS.AES.decrypt(decodeURIParam, 'RLm-Auf76eshsdafuUSDfa').toString(CryptoJS.enc.Utf8);
        const pramList = plainTextParam.split("/");
        const scheme = 'com.gofrugal.' + pramList[pramList.length - 2];
        const appleId = pramList[pramList.length - 1];
        
        window.location =scheme+"://" + scheme + "/" + plainTextParam;   
    }
       
        window.onload = init;
       
    </script>
    
    <a href="itms-apps://itunes.apple.com/app/id1615539302">Visit Tie</a>
</body>

</html>
